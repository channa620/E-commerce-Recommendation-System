{% extends "layout.html" %}
{% block content %}
<div class="row mb-4">
  <div class="col-md-8">
    <h4>Products</h4>
    <div class="row">
      {% for p in products %}
      <div class="col-md-4 mb-3">
        <div class="card product-card">
          <img src="{{ p.image }}" class="card-img-top product-img" alt="{{ p.product_name }}">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ p.product_name }}</h5>
            <p class="card-text">{{ p.category }}</p>
            <form method="post" action="{{ url_for('add_to_cart', product_id=p.product_id) }}" class="mt-auto">
              <button class="btn btn-primary w-100" type="submit">Add to cart</button>
            </form>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  <div class="col-md-4">
    <h4>Your Cart</h4>
    <ul class="list-group mb-3">
      {% if cart %}
        {% for pid in cart %}
          {% set item = (products|selectattr('product_id','equalto',pid)|list)[0] %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            {{ item.product_name }}
            <form method="post" action="{{ url_for('remove_from_cart', product_id=pid) }}">
              <button class="btn btn-sm btn-danger">Remove</button>
            </form>
          </li>
        {% endfor %}
      {% else %}
        <li class="list-group-item">Cart is empty</li>
      {% endif %}
    </ul>
<style>
  .product-img {
  width: 100%;          /* take full width of the block */
  height: 100%;         /* take full height of the block */
  object-fit: cover;    /* or "contain" depending on need */
  border-radius: 8px;   /* optional, for rounded look */
}

</style>
    <h5>Recommended For You</h5>
    <div class="row">
      {% for r in recommendations %}
      <div class="col-12 mb-2">
        <div class="card">
          <div class="row g-0 align-items-center">
            <div class="col-4"><img src="{{ r.image }}" class="img-fluid" alt="{{ r.product_name }}"></div>
            <div class="col-8 p-2">
              <strong>{{ r.product_name }}</strong><br>
              <small>{{ r.category }}</small>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}